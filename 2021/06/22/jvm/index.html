<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fl911.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="JVM类加载器类的生命周期加载 -&gt; 验证 -&gt; 准备 -&gt; 解析 -&gt; 初始化 -&gt; 使用 -&gt; 销毁  验证阶段 这一步就是根据 java 虚拟机规范，来校验加载进来的 .class 文件中的内容，是否符合指定的规范">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM详解及JVM调优">
<meta property="og:url" content="https://fl911.github.io/2021/06/22/jvm/index.html">
<meta property="og:site_name" content="Dragon">
<meta property="og:description" content="JVM类加载器类的生命周期加载 -&gt; 验证 -&gt; 准备 -&gt; 解析 -&gt; 初始化 -&gt; 使用 -&gt; 销毁  验证阶段 这一步就是根据 java 虚拟机规范，来校验加载进来的 .class 文件中的内容，是否符合指定的规范">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fl911.github.io/2021/06/22/jvm/0.jpg">
<meta property="article:published_time" content="2021-06-22T06:55:06.000Z">
<meta property="article:modified_time" content="2023-06-16T09:14:25.064Z">
<meta property="article:author" content="Dragon">
<meta property="article:tag" content="java">
<meta property="article:tag" content="jvm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fl911.github.io/2021/06/22/jvm/0.jpg">

<link rel="canonical" href="https://fl911.github.io/2021/06/22/jvm/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>JVM详解及JVM调优 | Dragon</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script type="text/javascript" src="/js/click/clicklove.js"></script>
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Dragon</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">业精于勤荒于嬉</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/fl911" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fl911.github.io/2021/06/22/jvm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head-img.jpeg">
      <meta itemprop="name" content="Dragon">
      <meta itemprop="description" content="java">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dragon">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JVM详解及JVM调优
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-22 14:55:06" itemprop="dateCreated datePublished" datetime="2021-06-22T14:55:06+08:00">2021-06-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-16 17:14:25" itemprop="dateModified" datetime="2023-06-16T17:14:25+08:00">2023-06-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="JVM类加载器"><a href="#JVM类加载器" class="headerlink" title="JVM类加载器"></a>JVM类加载器</h2><h3 id="类的生命周期"><a href="#类的生命周期" class="headerlink" title="类的生命周期"></a>类的生命周期</h3><p><strong>加载 -&gt; 验证 -&gt; 准备 -&gt; 解析 -&gt; 初始化 -&gt; 使用 -&gt; 销毁</strong></p>
<ul>
<li><p><strong>验证阶段</strong></p>
<p>这一步就是根据 java 虚拟机规范，来校验加载进来的 .class 文件中的内容，是否符合指定的规范</p>
</li>
</ul>
<span id="more"></span>

<ul>
<li><p><strong>准备阶段</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> age = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>准备工作，其实就是给这个 <code>User</code> 类分配一定的内存空间，然后给他里面的类变量（<code>static</code> 修饰的变量）分配内存空间，来一个默认的值。</p>
<p>比如上面的代码里，就会给 <code>age</code> 这个类变量分配内存空间，并且给一个默认值 0。</p>
</li>
<li><p><strong>解析阶段</strong></p>
<p>这个阶段实际上是把 <strong>符号引用替换为直接引用</strong></p>
</li>
<li><p><strong>初始化阶段</strong></p>
<p>这个阶段就会执行初始化代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> age = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, String&gt; map;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>初始化的时候就会将之前给默认值的类变量的值改为真正我们设置的值，比如上面的 <code>age</code> ，准备阶段给了默认值 0，现在替换为我们设置的值 10。</p>
<p>另外，static 静态代码块，也会在这个阶段执行。</p>
<blockquote>
<p><strong>注意！！！</strong></p>
<p>如果在初始化一个类的时候，发现他的父类还没有初始化，那么必须先初始化他的父类。</p>
<p>并且 JVM 加载类是懒加载的，只有在使用到的时候才会加载（也就是说你在 <code>new User()</code> 的时候，这个 <code>User</code> 类才会被加载）</p>
</blockquote>
</li>
</ul>
<h3 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h3><ul>
<li><p>启动类加载器    Bootstrap ClassLoader</p>
<p>主要用来加载我们机器上安装的 Java 目录下的核心类，也就是 Java 安装目录下的 <code>jre\lib</code> 目录。JVM 一启动，就会首先加载该目录下的核心类。</p>
</li>
<li><p>扩展类加载器    Extension ClassLoader</p>
<p>主要用来加载我们机器上安装的 Java 目录下的核心类，也就是 Java 安装目录下的 <code>jre\lib\ext</code> 目录。JVM 一启动，就会首先加载该目录下的核心类。</p>
</li>
<li><p>应用程序类加载器    Application ClassLoader</p>
<p>主要用来加载 <code>ClassPath</code> 环境变量所指定的路径中的类，其实可以理解为就是加载我们写好的 Java 代码。</p>
</li>
<li><p>自定义类加载器</p>
<p>除了上面三种之外，还可以自定义类加载器，去根据自己的需求来加载类。</p>
</li>
</ul>
<h3 id="双亲委派机制"><a href="#双亲委派机制" class="headerlink" title="双亲委派机制"></a>双亲委派机制</h3><p>类加载器是有亲子层结构的（不是 Java 中的父类子类），就是说启动类加载器在最上层，扩展类加载器在第二层，应用程序类加载器在第三层，自定义类加载器在最后一层。如下图：</p>
<img src="/2021/06/22/jvm/0.jpg" class="" title="jvm">

<p>双亲委派的意思是：</p>
<p>假如你的<strong>应用程序类加载器</strong>要加载一个类，</p>
<p>它首先会向上委派给<strong>扩展类加载器</strong>去加载，</p>
<p><strong>扩展类加载器</strong>也不会先加载，首先会向上委派给<strong>启动类加载器</strong>去加载。</p>
<p>如果<strong>启动类加载器</strong>没有找到这个类，则再往下委派给<strong>扩展类加载器</strong>去加载，如果<strong>扩展类加载器</strong>也没有找到这个类，则再继续往下委派给<strong>应用程序类加载器</strong>去加载。</p>
<p>也就是会从上往下加载，如果中途有一个类加载器加载到了该类，就不再往下走。</p>
<p>这就是双亲委派机制：先找父类加载，找不到的话再由儿子来加载。这么做的好处就是，可以避免多层级的类加载器重复加载某些类。</p>
<h2 id="JVM参数"><a href="#JVM参数" class="headerlink" title="JVM参数"></a>JVM参数</h2><h3 id="Xmn-Xms-Xmx-Xss有什么区别"><a href="#Xmn-Xms-Xmx-Xss有什么区别" class="headerlink" title="Xmn Xms Xmx Xss有什么区别"></a>Xmn Xms Xmx Xss有什么区别</h3><p>Xmn、Xms、Xmx、Xss都是JVM对内存的配置参数，我们可以根据不同需要区修改这些参数，以达到运行程序的最好效果。</p>
<ul>
<li><strong>-Xms</strong> 堆内存的初始大小，默认为物理内存的1/64。<em>此值必须是大于1 MB的1024的倍数。</em> <code>jdk8以后也可以使用 -XX:InitialHeapSize=1024M 来设置</code></li>
<li><strong>-Xmx</strong> 堆内存的最大大小，默认为物理内存的1/4。<em>此值必须是大于1 MB的1024的倍数。</em> <code>jdk8以后也可以使用 -XX:MaxHeapSize=1024M 来设置</code></li>
<li><strong>-Xmn</strong> 堆内新生代的大小。通过这个值也可以得到老生代的大小：-Xmx减去-Xmn <code>jdk8以后也可以使用 -XX:NewSize=512M -XX:MaxNewSize=512M 来设置</code></li>
<li><strong>-Xss</strong> 设置每个线程可使用的内存大小，即栈的大小。在相同物理内存下，减小这个值能生成更多的线程，当然操作系统对一个进程内的线程数还是有限制的，不能无限生成。线程栈的大小是个双刃剑，如果设置过小，可能会出现栈溢出，特别是在该线程内有递归、大的循环时出现溢出的可能性更大，如果该值设置过大，就有影响到创建栈的数量，如果是多线程的应用，就会出现内存溢出的错误。</li>
</ul>
<h3 id="通用参数"><a href="#通用参数" class="headerlink" title="通用参数"></a>通用参数</h3><ul>
<li><strong>-XX:NewRatio=2</strong> 设置新生代和老年代的比值。如：为3，表示年轻代与老年代比值为1：3</li>
<li><strong>-XX:SurvivorRatio=8</strong> 新生代中Eden区与两个Survivor区的比值，默认为8。注意Survivor区有两个。如：为3，表示Eden：Survivor=3：2，一个Survivor区占整个新生代的1/5</li>
<li><strong>-XX:MaxTenuringThreshold=15</strong> 对象晋升老年代的年龄，默认为15。如果是0，则直接跳过新生代进入老年代</li>
<li><strong>-XX:PermSize=256M</strong>、**-XX:MaxPermSize=256M** 分别设置永久代最小大小与最大大小（Java8以前）</li>
<li><strong>-XX:MetaspaceSize=256M</strong>、**-XX:MaxMetaspaceSize=256M** 分别设置元空间最小大小与最大大小（Java8以后）</li>
<li><strong>-XX:PretenureSizeThreshold=1M</strong> 大对象大小，超过这个值的大对象直接放入老年代</li>
<li><strong>-XX:+TraceClassLoading</strong> 开启打印类加载器加载了哪些类</li>
<li><strong>-XX:+TraceClassUnloading</strong> 开启打印类加载器卸载了哪些类</li>
<li><strong>-XX:+DisableExplicitGC</strong> 禁止显示执行 GC ，说白了就是不允许在代码中通过 System.gc() 来执行 GC。<blockquote>
<p>NIO 在创建堆外内存的时候，如果发现内存不足，会通过 System.gc() 来触发 JVM 的 Full GC，回收掉堆中已经没有被引用的 DirectByteBuffer 对象。如果开启了该参数，可能会导致 NIO 的 System.gc() 也不生效。最终导致堆外 OOM （当然避免这种情况的最好办法，还是合理的分配 JVM 内存，让变为垃圾的 DirectByteBuffer 对象尽量在新生代就被回收掉）</p>
</blockquote>
</li>
<li><strong>-XX:+PrintGC</strong> 或 <strong>-verbose:gc</strong> 开启gc日志打印</li>
<li><strong>-XX:+PrintGCDetails</strong> 打印 GC 日志</li>
<li><strong>-XX:+PrintGCTimeStamps</strong> 打印 GC 执行时间日志</li>
<li><strong>-Xloggc:/tmp/gc.log</strong> 将 GC 日志输出到指定文件</li>
<li><strong>-XX:SoftRefLRUPolicyMSPerMB=1000</strong> 软引用对象的存活时长时间（单位ms）<blockquote>
<p>有一个公式</p>
<blockquote>
<p>clock - timestamp &lt;= freespace * SoftRefLRUPolicyMSPerMB</p>
<p>clock - timestamp 代表一个软引用对象多久没有被访问过了</p>
<p>freespace 代表 JVM 中的空闲内存空间</p>
<p>SoftRefLRUPolicyMSPerMB 代表每一MB空闲内存空间可以允许软引用对象存活多久</p>
</blockquote>
<p>当然在一般 GC 的时候， JVM 或多或少都会有一些内存空间的，所以基本上如果不是快要发生 OOM，一般软引用对象也不会被回收</p>
<p><strong>注意！！！</strong></p>
<p>因为反射的成本是很高的，JVM 在处理反射的时候做了一些优化，如果一个反射被调用了多次以后，JVM 就会自动创建一个软引用的对象，大概比如<code>sun.reflect.GeneratedConstructorAccessor</code> 或者 <code>sun.reflect.GeneratedMethodAccessor</code> 之类的。这样在后面继续调用反射的时候，就可以直接调用这些对象的方法来代替反射，从而提高效率。</p>
<p>所以 -XX:SoftRefLRUPolicyMSPerMB 这个参数的值一定不能设置为 0 ，而且如果系统中有大量反射的时候，还需要把该参数设置大一些，比如 1000， 2000， 3000， 或者 5000 毫秒，都可以。</p>
</blockquote>
</li>
</ul>
<h3 id="设置垃圾收集器"><a href="#设置垃圾收集器" class="headerlink" title="设置垃圾收集器"></a>设置垃圾收集器</h3><ul>
<li><strong>-XX:+UseParNewGC</strong> 设置新生代多线程收集器 <em>一般搭配 CMS 使用</em> <code>注意：ParNew 在单核环境下是不如 Serial 的，在多核的条件下才有优势</code></li>
<li><strong>-XX:+UseConcMarkSweepGC</strong> 设置CMS收集器 （老年代）</li>
<li><strong>-XX:+UseG1GC</strong> 设置G1收集器 <em>jdk9的默认收集器</em> （新生代和老年代）</li>
<li><strong>-XX:+UseParallelGC</strong> 设置多线程收集器 <em>jdk8的默认新生代收集器</em> （新生代） <code>与 ParNew 的区别是，Parallel 注重的是吞吐量</code></li>
<li><strong>-XX:+UseParallelOldGC</strong> 设置并行老年代收集器 <code>在注重吞吐量的场景下，可以采用 Parallel Scavenge + Parallel Old 的组合</code></li>
<li><strong>-XX:+UseSerialOldGC</strong> 设置串行收集器 <code>CMS和G1回收失败以后会转为该收集器，性能超级低</code></li>
</ul>
<h3 id="CMS-参数"><a href="#CMS-参数" class="headerlink" title="CMS 参数"></a>CMS 参数</h3><ul>
<li><strong>-XX:CMSInitiatingOccupancyFaction=92</strong> 设置老年代占用多少比例的时候触发CMS垃圾回收，jdk1.6 默认是 92%</li>
<li><strong>-XX:+UseCMSInitiatingOccupancyOnly</strong> 一般配合上面的参数一起使用。如果只设置上面的参数而没有设置该参数，JVM仅在第一次使用设定值,后续则自动调整。然而，请记住大多数情况下，JVM比我们自己能作出更好的垃圾收集决策。因此，只有当我们充足的理由(比如测试)并且对应用程序产生的对象的生命周期有深刻的认知时，才应该使用该标志。</li>
<li><strong>-XX:+UseCMSCompactAtFullCollection</strong> 开启内存碎片整理</li>
<li><strong>-XX:CMSFullGCsBeforeCompaction=0</strong> 执行多少次Full gc 之后再执行一次内存碎片整理的工作，默认是0，意思是每次Full gc之后都整理</li>
<li><strong>-XX:+CMSParallelInitialMarkEnabled</strong> 这个参数会在CMS垃圾回收器的“初始标记”阶段开启多线程并发执行</li>
<li><strong>-XX:+CMSScavengeBeforeRemark</strong> 这个参数会在CMS的重新标记阶段之前，先尽量执行一次Young GC。如果在重新标记之前，先执行一次Young GC，就会回收掉一些年轻代里没有人引用的对象。所以如果先提前回收掉一些对象，那么在CMS的重新标记阶段就可以少扫描一些对象，此时就可以提升CMS的重新标记阶段的性能，减少他的耗时</li>
</ul>
<h3 id="G1参数"><a href="#G1参数" class="headerlink" title="G1参数"></a>G1参数</h3><ul>
<li><strong>-XX:G1HeapRegionSize</strong> 手动指定 region 的大小，最小 1M，最大 32M。一般采用默认就行，当然如果机器内存很大，比如 32G，这时候需要适当调大该参数，防止 Region 过多，比如调整为 16M</li>
<li><strong>-XX:G1NewSizePercent=5</strong> 设置新生代初始占比，默认是5%</li>
<li><strong>-XX:G1MaxNewSizePercent=60</strong> 设置新生代最大占比，默认是60%</li>
<li><strong>-XX:G1MixedGCCountTarget=8</strong> 设置一次混合回收分为几个阶段来执行，默认是8次</li>
<li><strong>-XX:G1HeapWastePercent=5</strong> 设置混合回收空出来的Region数量达到了堆内存的多少，就立即停止混合回收。默认5%</li>
<li><strong>-XX:G1MixedGCLiveThresholdPercent</strong>=85 确定要回收Region的时候，必须是存活对象低于多少的Region才可以进行回收，默认是85%</li>
<li><strong>-XX:InitiatingHeapOccupancyPercent=45</strong> 设置老年代占据了堆内存多大的时候，尝试触发 新生代+老年代 的混合回收（Mixed GC），默认是45%</li>
</ul>
<h2 id="JVM调优工具"><a href="#JVM调优工具" class="headerlink" title="JVM调优工具"></a>JVM调优工具</h2><h3 id="jstat"><a href="#jstat" class="headerlink" title="jstat"></a>jstat</h3><blockquote>
<p>用来查看正在运行的 JVM 的各个指标数据</p>
</blockquote>
<h4 id="jstat-gc-PID"><a href="#jstat-gc-PID" class="headerlink" title="jstat -gc PID"></a>jstat -gc PID</h4><blockquote>
<p>查看 JVM 的内存情况和GC情况</p>
</blockquote>
<p>每一列的解释：（以 KB 为单位）</p>
<p><strong>S0C</strong>：这是 From Survivor 区的大小</p>
<p><strong>S1C</strong>：这是 To Survivor 区的大小</p>
<p><strong>S0U</strong>：这是 From Survivor 区当前使用的大小</p>
<p><strong>S1U</strong>：这是 To Survivor 区当前使用的大小</p>
<p><strong>EC</strong>：这是 Eden 区的大小</p>
<p><strong>ECU</strong>：这是 Eden 区当前使用的大小</p>
<p><strong>OC</strong>：这是 老年代 的大小</p>
<p><strong>OU</strong>：这是 老年代 当前使用的大小</p>
<p><strong>MC</strong>：这是 方法区（永久代、元数据区） 的大小</p>
<p><strong>MU</strong>：这是 方法区（永久代、元数据区） 当前使用的大小</p>
<p><strong>CCSC</strong>：这是 压缩类空间 的大小</p>
<p><strong>CCSC</strong>：这是 压缩类空间 当前使用的大小</p>
<p><strong>YGC</strong>：这是系统运行迄今为止的 Young GC 次数</p>
<p><strong>YGCT</strong>：这是 Young GC 的耗时</p>
<p><strong>FGC</strong>：这是系统运行迄今为止的 Full GC 次数</p>
<p><strong>FGCT</strong>：这是 Full GC 的耗时</p>
<p><strong>GCT</strong>：这是 所有GC 的总耗时</p>
<h4 id="jstat-gccapacity-PID"><a href="#jstat-gccapacity-PID" class="headerlink" title="jstat -gccapacity PID"></a>jstat -gccapacity PID</h4><blockquote>
<p>堆内存分析</p>
</blockquote>
<h4 id="jstat-gcnew-PID"><a href="#jstat-gcnew-PID" class="headerlink" title="jstat -gcnew PID"></a>jstat -gcnew PID</h4><blockquote>
<p>年轻代 GC 分析，这里的 TT 和 MTT 可以看到对象在年轻代存活的年龄和存活的最大年龄</p>
</blockquote>
<h4 id="jstat-gcnewcapacity-PID"><a href="#jstat-gcnewcapacity-PID" class="headerlink" title="jstat -gcnewcapacity PID"></a>jstat -gcnewcapacity PID</h4><blockquote>
<p>年轻代内存分析</p>
</blockquote>
<h4 id="jstat-gcold-PID"><a href="#jstat-gcold-PID" class="headerlink" title="jstat -gcold PID"></a>jstat -gcold PID</h4><blockquote>
<p>老年代 GC 分析</p>
</blockquote>
<h4 id="jstat-gcoldcapacity-PID"><a href="#jstat-gcoldcapacity-PID" class="headerlink" title="jstat -gcoldcapacity PID"></a>jstat -gcoldcapacity PID</h4><blockquote>
<p>老年代内存分析</p>
</blockquote>
<h4 id="jstat-gcmetacapacity-PID"><a href="#jstat-gcmetacapacity-PID" class="headerlink" title="jstat -gcmetacapacity PID"></a>jstat -gcmetacapacity PID</h4><blockquote>
<p>元数据区内存分析</p>
</blockquote>
<h3 id="jmap"><a href="#jmap" class="headerlink" title="jmap"></a>jmap</h3><h4 id="jmap-heap-PID"><a href="#jmap-heap-PID" class="headerlink" title="jmap -heap PID"></a>jmap -heap PID</h4><blockquote>
<p>打印堆内存相关的一些参数和各个区域的内存情况</p>
</blockquote>
<h4 id="jmap-histo-PID"><a href="#jmap-histo-PID" class="headerlink" title="jmap -histo PID"></a>jmap -histo PID</h4><blockquote>
<p>打印各个对象占用内存空间的大小，从大到小排列</p>
</blockquote>
<h4 id="jmap-dump-live-format-b-file-dump-hprof-PID"><a href="#jmap-dump-live-format-b-file-dump-hprof-PID" class="headerlink" title="jmap -dump:live,format=b,file=dump.hprof PID"></a>jmap -dump:live,format=b,file=dump.hprof PID</h4><blockquote>
<p>生成堆转储快照，也可以在系统启动的时候指定参数 -XX:+HeapDumpOnOutOfMemoryError 和 -XX:HeapDumpPath=/home/heapdump.hprof 来开启在系统发生 OOM 的时候自动生成堆转储文件，方便分析</p>
</blockquote>
<h3 id="jhat"><a href="#jhat" class="headerlink" title="jhat"></a>jhat</h3><h4 id="jhat-dump-hprof-port-7000"><a href="#jhat-dump-hprof-port-7000" class="headerlink" title="jhat dump.hprof -port 7000"></a>jhat dump.hprof -port 7000</h4><blockquote>
<p>启动 jhat 服务器，其中 dump.hprof 就是上一步使用 jmap -dump 来生成的堆转储文件名称</p>
<p>启动以后就可以在浏览器访问这台机器的 7000 端口号，通过图形化的方式去分析堆内存里的对象分布情况了</p>
<p>不过功能比较弱小，一般都是用 MAT 工具</p>
</blockquote>
<h3 id="MAT-工具"><a href="#MAT-工具" class="headerlink" title="MAT 工具"></a>MAT 工具</h3><h4 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h4><p><a target="_blank" rel="noopener" href="https://www.eclipse.org/mat/downloads.php">https://www.eclipse.org/mat/downloads.php</a></p>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>下载好以后，在他的安装目录里，可以看到一个文件名字叫做：MemoryAnalyzer.ini</p>
<blockquote>
<p><strong>注意：</strong></p>
<p>如果 dump 出来的内存快照很大，比如有几个G，务必要记得在启动 MAT 之前先在这个配置文件里面给 MAT 本身设置一下堆大小，比如设置4个G、8个G。</p>
<p>他这里默认 -Xmx1024m 是1G</p>
</blockquote>
<p>然后启动 MAT 即可，启动之后看到界面中有一个 <code>Open a Heap Dump</code>，就是打开一个内存快照，然后上传之前的 dump 文件即可。</p>
<p>打开一个快照后，上面工具栏里有一个按钮，<code>Leak Suspects</code>，是用来进行 <code>内存泄漏</code> 分析的</p>
<h2 id="JVM如何调优"><a href="#JVM如何调优" class="headerlink" title="JVM如何调优"></a>JVM如何调优</h2><blockquote>
<p>调优无非就是尽可能的减少 Full GC，想要减少 Full GC，就需要尽量减少对象进入老年代，让大部分对象在 Young GC 的时候就清理掉</p>
</blockquote>
<h3 id="对象在什么情况下进入老年代"><a href="#对象在什么情况下进入老年代" class="headerlink" title="对象在什么情况下进入老年代"></a>对象在什么情况下进入老年代</h3><ul>
<li>对象的年龄达到了 <code>MaxTenuringThreshold</code> 设置的年龄大小（默认15）以后，就会进入老年代</li>
<li>Young GC 后的存活对象 &gt; Survivor 的大小，这批存活对象直接进入老年代</li>
<li>大对象（<code>PretenureSizeThreshold</code>设置的大小）直接进入老年代</li>
<li>动态年龄判断，每次 Young GC 后，Survivor里存活的对象从最低年龄往上加，比如 年龄1 + 年龄2 + 年龄3 + …，加到年龄3以后总大小超过了 Survivor 大小的 50%，那么 &gt;= 年龄3 的对象直接进入老年代</li>
</ul>
<h3 id="我们在调优的时候最想知道哪些信息？"><a href="#我们在调优的时候最想知道哪些信息？" class="headerlink" title="我们在调优的时候最想知道哪些信息？"></a>我们在调优的时候最想知道哪些信息？</h3><p>新生代对象的增长速率，Young GC 的触发频率，Young GC 的耗时，每次 Young GC 后有多少对象是存活下来的，每次 Young GC 后有多少对象进入了老年代</p>
<p>老年代对象的增长速率，Full GC 的触发频率，Full GC 的耗时</p>
<h4 id="新生代对象的增长速率"><a href="#新生代对象的增长速率" class="headerlink" title="新生代对象的增长速率"></a>新生代对象的增长速率</h4><p>要分析这个东西，需要使用这个命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jstat -gc PID 1000 10</span><br></pre></td></tr></table></figure>

<p>后边的 1000  10 啥意思呢？</p>
<p>就是说 每1000 毫秒执行输出一次，连着输出 10 次</p>
<p><strong>稍微通用一点的模板</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Xms4096M -Xmx4096M -Xmn3072M -Xss1M  -XX:PermSize=256M -XX:MaxPermSize=256M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFaction=92 -XX:+UseCMSCompactAtFullCollection -XX:CMSFullGCsBeforeCompaction=0 -XX:+CMSParallelInitialMarkEnabled -XX:+CMSScavengeBeforeRemark -XX:+DisableExplicitGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:/usr/local/app/gc/gc.log -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/usr/local/app/oom/</span><br></pre></td></tr></table></figure>


<h2 id="JVM问题排查"><a href="#JVM问题排查" class="headerlink" title="JVM问题排查"></a>JVM问题排查</h2><h3 id="查找cpu占用高的线程"><a href="#查找cpu占用高的线程" class="headerlink" title="查找cpu占用高的线程"></a>查找cpu占用高的线程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 首先查看进程，找到cpu使用率最高的进程pid</span></span><br><span class="line">top</span><br><span class="line"><span class="meta">#</span><span class="bash"> 找到cpu使用率最高的线程pid</span></span><br><span class="line">top -Hp 进程pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将线程pid转换为16进制，为后面查找jstack日志做准备</span></span><br><span class="line">printf &#x27;%x\n&#x27; 线程pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看线程栈信息，例如 jstack 1040 | vim +/0x431 -</span></span><br><span class="line">jstack 进程pid | vim +/十六进制线程pid -</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/java/" rel="tag"># java</a>
              <a href="/tags/jvm/" rel="tag"># jvm</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/28/nginx/" rel="prev" title="nginx 常用配置">
      <i class="fa fa-chevron-left"></i> nginx 常用配置
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/06/22/dynamic-log-level/" rel="next" title="SpringBoot动态修改日志级别">
      SpringBoot动态修改日志级别 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-number">1.</span> <span class="nav-text">JVM类加载器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">1.1.</span> <span class="nav-text">类的生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-number">1.2.</span> <span class="nav-text">类加载器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%9C%BA%E5%88%B6"><span class="nav-number">1.3.</span> <span class="nav-text">双亲委派机制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E5%8F%82%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">JVM参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Xmn-Xms-Xmx-Xss%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="nav-number">2.1.</span> <span class="nav-text">Xmn Xms Xmx Xss有什么区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E5%8F%82%E6%95%B0"><span class="nav-number">2.2.</span> <span class="nav-text">通用参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8"><span class="nav-number">2.3.</span> <span class="nav-text">设置垃圾收集器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CMS-%E5%8F%82%E6%95%B0"><span class="nav-number">2.4.</span> <span class="nav-text">CMS 参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#G1%E5%8F%82%E6%95%B0"><span class="nav-number">2.5.</span> <span class="nav-text">G1参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E8%B0%83%E4%BC%98%E5%B7%A5%E5%85%B7"><span class="nav-number">3.</span> <span class="nav-text">JVM调优工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#jstat"><span class="nav-number">3.1.</span> <span class="nav-text">jstat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gc-PID"><span class="nav-number">3.1.1.</span> <span class="nav-text">jstat -gc PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gccapacity-PID"><span class="nav-number">3.1.2.</span> <span class="nav-text">jstat -gccapacity PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gcnew-PID"><span class="nav-number">3.1.3.</span> <span class="nav-text">jstat -gcnew PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gcnewcapacity-PID"><span class="nav-number">3.1.4.</span> <span class="nav-text">jstat -gcnewcapacity PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gcold-PID"><span class="nav-number">3.1.5.</span> <span class="nav-text">jstat -gcold PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gcoldcapacity-PID"><span class="nav-number">3.1.6.</span> <span class="nav-text">jstat -gcoldcapacity PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jstat-gcmetacapacity-PID"><span class="nav-number">3.1.7.</span> <span class="nav-text">jstat -gcmetacapacity PID</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jmap"><span class="nav-number">3.2.</span> <span class="nav-text">jmap</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jmap-heap-PID"><span class="nav-number">3.2.1.</span> <span class="nav-text">jmap -heap PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jmap-histo-PID"><span class="nav-number">3.2.2.</span> <span class="nav-text">jmap -histo PID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jmap-dump-live-format-b-file-dump-hprof-PID"><span class="nav-number">3.2.3.</span> <span class="nav-text">jmap -dump:live,format&#x3D;b,file&#x3D;dump.hprof PID</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jhat"><span class="nav-number">3.3.</span> <span class="nav-text">jhat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jhat-dump-hprof-port-7000"><span class="nav-number">3.3.1.</span> <span class="nav-text">jhat dump.hprof -port 7000</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MAT-%E5%B7%A5%E5%85%B7"><span class="nav-number">3.4.</span> <span class="nav-text">MAT 工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80"><span class="nav-number">3.4.1.</span> <span class="nav-text">下载地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">3.4.2.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E5%A6%82%E4%BD%95%E8%B0%83%E4%BC%98"><span class="nav-number">4.</span> <span class="nav-text">JVM如何调优</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E5%9C%A8%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E8%BF%9B%E5%85%A5%E8%80%81%E5%B9%B4%E4%BB%A3"><span class="nav-number">4.1.</span> <span class="nav-text">对象在什么情况下进入老年代</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E4%BB%AC%E5%9C%A8%E8%B0%83%E4%BC%98%E7%9A%84%E6%97%B6%E5%80%99%E6%9C%80%E6%83%B3%E7%9F%A5%E9%81%93%E5%93%AA%E4%BA%9B%E4%BF%A1%E6%81%AF%EF%BC%9F"><span class="nav-number">4.2.</span> <span class="nav-text">我们在调优的时候最想知道哪些信息？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E7%94%9F%E4%BB%A3%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A2%9E%E9%95%BF%E9%80%9F%E7%8E%87"><span class="nav-number">4.2.1.</span> <span class="nav-text">新生代对象的增长速率</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5"><span class="nav-number">5.</span> <span class="nav-text">JVM问题排查</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BEcpu%E5%8D%A0%E7%94%A8%E9%AB%98%E7%9A%84%E7%BA%BF%E7%A8%8B"><span class="nav-number">5.1.</span> <span class="nav-text">查找cpu占用高的线程</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dragon"
      src="/images/head-img.jpeg">
  <p class="site-author-name" itemprop="name">Dragon</p>
  <div class="site-description" itemprop="description">java</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fl911" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fl911" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/519625362@qq.com" title="E-Mail → 519625362@qq.com"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dragon</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'e1ed6bf0f2e2dca72283',
      clientSecret: '9e80b6dd00be7d699e117873174e5e17d1a8aa80',
      repo        : 'Dragon-Wong.github.io',
      owner       : 'Dragon-Wong',
      admin       : ['Dragon-Wong'],
      id          : '31998337150082366e511fee9d50fcbc',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
